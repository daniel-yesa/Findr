<!DOCTYPE html>
<html>
<head>
    <title>Findr Report</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" />
    <style>
        body { background-color: #1e1e1e; color: white; font-family: Arial; }
        table { border-collapse: collapse; width: 100%; margin-top: 15px; background-color: #2b2b2b; }
        th, td { padding: 8px; border: 1px solid #444; }
        th { background-color: #333; }
        tr:hover { background-color: #444; }
        /* White background when copying to Excel */
        table td, table th {
            background-color: #ffffff !important;
            color: #000000 !important;
        }
    </style>
</head>
<body>
    <h2>Findr Report</h2>
    <form method="POST" enctype="multipart/form-data">
        <p><input type="file" name="csv_file" required></p>
        <p><input type="text" name="sheet_url" placeholder="Google Sheet URL" required></p>
        <p><input type="text" name="date_range" id="date_range" placeholder="MM/DD/YYYY - MM/DD/YYYY" required></p>
        <p><input type="text" name="appealer_name" placeholder="Appealer Name" required></p>
        <p><button type="submit">Run Report</button></p>
    </form>

    {% if show_results %}
        <h3>Ontario Open Appeals</h3>
        <table>
            <tr>
                {% for col in ontario[0].keys() %}
                    <th>{{ col }}</th>
                {% endfor %}
            </tr>
            {% for row in ontario %}
                <tr>
                    {% for value in row.values() %}
                        <td>{{ value }}</td>
                    {% endfor %}
                </tr>
            {% endfor %}
        </table>

        <h3>Quebec Open Appeals</h3>
        <table>
            <tr>
                {% for col in quebec[0].keys() %}
                    <th>{{ col }}</th>
                {% endfor %}
            </tr>
            {% for row in quebec %}
                <tr>
                    {% for value in row.values() %}
                        <td>{{ value }}</td>
                    {% endfor %}
                </tr>
            {% endfor %}
        </table>
    {% endif %}

    <script src="https://cdn.jsdelivr.net/jquery/latest/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>
    <script>
        $(function() {
            $('#date_range').daterangepicker({
                autoUpdateInput: true,
                locale: { format: 'MM/DD/YYYY' }
            });
        });
    </script>
</body>
</html>
